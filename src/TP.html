<html>

<head>
    <link rel="stylesheet" href="estilo.css">
    <title>Trabajo Pr&#225;ctico</title>
    <meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">

    <script type="text/javascript" src="js/gl-matrix.js"></script>
    <script type="text/javascript" src="js/webgl-utils.js"></script>
    <script type="text/javascript" src="js/dat.gui.min.js"></script>
    <script type="text/javascript" src="js/jquery-2.2.4.min.js"></script>
    <script type="text/javascript" src="js/Util/Calculator.js"></script>
    <script type="text/javascript" src="js/GraphicalUserInterfaceControl/GraphicalUserInterfaceControl.js"></script>
    <script type="text/javascript" src="js/TextureHandler.js"></script>
    <script type="text/javascript" src="js/Definitions/Definitions.js"></script>
    <script type="text/javascript" src="js/Camera/MouseController.js"></script>
    <script type="text/javascript" src="js/Shader/Compiler.js"></script>
    <script type="text/javascript" src="js/Shader/Linker.js"></script>
    <script type="text/javascript" src="js/ModelViewMatrixStack.js"></script>
    <script type="text/javascript" src="js/GraphicContainer/WebGlRenderingContext.js"></script>
    <script type="text/javascript" src="js/GraphicContainer/ThreeDimensionRenderingContext.js"></script>
    <script type="text/javascript" src="js/GraphicContainer/TwoDimensionRenderingContext.js"></script>
    <script type="text/javascript" src="js/GraphicContainer/GraphicContainer.js"></script>
    <script type="text/javascript" src="js/GraphicContainer/SceneGraphicContainer.js"></script>
    <script type="text/javascript" src="js/GraphicContainer/RiverMapGraphicContainer.js"></script>
    <script type="text/javascript" src="js/Curves/Bspline.js"></script>
    <script type="text/javascript" src="js/Curves/BsplineMatrix.js"></script>
    <script type="text/javascript" src="js/AnimationFrame/AnimationFrame.js"></script>
    <script type="text/javascript" src="js/AnimationFrame/Scene.js"></script>

    <script type="text/javascript" src="js/GraphicalObject/GraphicalObject.js"></script>
    <script type="text/javascript" src="js/GraphicalObject/Cylinder.js"></script>
    <script type="text/javascript" src="js/GraphicalObject/SweptSurface.js"></script>
    <script type="text/javascript" src="js/GraphicalObject/RevolutionSurface.js"></script>
    <script type="text/javascript" src="js/GraphicalObject/Grass.js"></script>
    <script type="text/javascript" src="js/GraphicalObject/GrassLeftSide.js"></script>
    <script type="text/javascript" src="js/GraphicalObject/GrassRightSide.js"></script>
    <script type="text/javascript" src="js/GraphicalObject/Ground.js"></script>
    <script type="text/javascript" src="js/GraphicalObject/Tree.js"></script>
    <script type="text/javascript" src="js/GraphicalObject/TreeCrown.js"></script>
    <script type="text/javascript" src="js/GraphicalObject/TreeTrunk.js"></script>
    <script type="text/javascript" src="js/Camera/Camera.js"></script>
    <script type="text/javascript" src="js/Camera/Orbital.js"></script>
    <script type="text/javascript" src="js/AnimationFrame/RiverMap.js"></script>
    <script id="shader-fs" type="x-shader/x-fragment">
            precision mediump float;
    varying vec2 vTextureCoord;
    varying vec3 vLightWeighting;

    uniform sampler2D uSampler;
void main() {
    vec4 textureColor = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));
    gl_FragColor = vec4(textureColor.rgb * vLightWeighting, textureColor.a);
}



    </script>
    <script id="shader-vs" type="x-shader/x-vertex">
        attribute vec3 aVertexPosition;
    attribute vec3 aVertexNormal;
    attribute vec2 aTextureCoord;
    attribute vec3 aVertexTangent;
	attribute vec3 aVertexBinormal;

    uniform mat4 uViewMatrix;
    uniform mat4 uModelMatrix;
    uniform mat4 uPMatrix;
    uniform mat3 uNMatrix;

    uniform vec3 uAmbientColor;

    uniform vec3 uLightPosition;
    uniform vec3 uDirectionalColor;

    uniform bool uUseLighting;

    varying vec2 vTextureCoord;
    varying vec3 vLightWeighting;

void main() {
    // Transformamos al vértice al espacio de la cámara
    vec4 pos_camera_view = uViewMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);

    // Transformamos al vértice al espacio de la proyección
    gl_Position = uPMatrix * pos_camera_view;

    // Coordenada de textura sin modifiaciones
    vTextureCoord = aTextureCoord;

    ////////////////////////////////////////////
    // Calculos de la iluminación
    vec3 light_dir =  uLightPosition - vec3( pos_camera_view );
    normalize(light_dir);
    if (!uUseLighting)
    {
        vLightWeighting = vec3(1.0, 1.0, 1.0);
    }
    else
    {
        vec3 transformedNormal = normalize(uNMatrix * aVertexNormal);
        float directionalLightWeighting = max(dot(transformedNormal, light_dir), 0.0);
        vLightWeighting = uAmbientColor + uDirectionalColor * directionalLightWeighting;
    }
    ////////////////////////////////////////////
}




    </script>

    <script type="text/javascript">
        var scene;
        var riverMap;
        var gl;
        var shaderProgram;
        var controlValues = {
            alturaMaxima: 10,
            reiniciar: function () {
                alert("apreto reiniciar");
            },
            detener: function () {
                alert("apreto detener");
            },
            modo: "random",
            riverWidth: 80,
            umbral: 100
        };
        var graphicalUSerInterfaceControl;
        function webGLStart() {
            try {
                graphicalUSerInterfaceControl = new GraphicalUserInterfaceControl();
                graphicalUSerInterfaceControl.start();
                riverMap = new RiverMap();
                riverMap.tick();
                refreshScene();
            } catch (e) {
                alert(e.name + " " + e.message);
            }
        }
        function refreshScene() {
            scene = new Scene(riverMap);
            scene.tick();
        }
    </script>

</head>
<body onload="webGLStart();">
<div style="text-align: right;">
    <canvas id="scene" style="border: double transparent;" width="1024" height="720">
        Your browser does not support the HTML5 canvas element.
    </canvas>
    <canvas id="riverMap" style="border: solid#696969;" width="360" height="360">
        Your browser does not support the HTML5 canvas element.
    </canvas>
</div>
<br>
<div style="text-align: center;">
    <input type="image" src="img/refresh.png" alt="Refresh" width="48" height="48" onclick="refreshScene()">
</div>
<br>
<div id="header">
    <h1>Tp Sistemas gr&aacuteficos - Ali, Luis - 2do. cuatrimestre de 2016</h1>
</div>
<div id="ref">
    <a href="#/" data-section="#camaras">Cambiar C&aacutemaras</a><br>
    <a href="#/" data-section="#CamaraOrbital">C&aacutemara orbital</a><br>
    <a href="#/" data-section="#CamaraPrimeraPersona">C&aacutemara primera persona</a>
</div>
<section id="camaras">
    <h2>Alternar C&aacutemaras</h2>
    <dl>
        <dt class="thick"><b style="color:blue;">Aletrna en el &oacuterden Orbital / Persona en el puente / Persona en
            el barco</b></dt>
        <dd class="italic">Tecla <b>C</b></dd>
    </dl>
</section>
<section id="CamaraOrbital">
    <h2>C&aacutemara orbital</h2>
    <dl>
        <dt class="thick">Zoom</dt>
        <dd class="italic">Acercar/Alejar, Mover rueda del mouse <b>Arriba/Abajo</b>
        <dd>
        <dt class="thick">Rotar la escena</dt>
        <dd class="italic">Mantener bot&oacuten izquierdo del mouse presionado y mover el mouse</dd>
    </dl>
</section>
<section id="CamaraPrimeraPersona">
    <h2>C&aacutemara de primera persona <b style="color:blue;font-size:70%;">(tanto en el puente como en el barco)</b>
    </h2>
    <dl>
        <dt class="thick">Desplazarse</dt>
        <dd class="italic">Izquierda/Atr&aacutes/Derecha/Adelante, <b>a/s/d/w</b> respectivamente
        <dd>
        <dt class="thick">Girar vista</dt>
        <dd class="italic">Mover el mouse manteniendo presionado el bot&oacuten izquierdo. La c&aacutemara mira al
            puntero del mouse
        </dd>
    </dl>
</section>
</section>
<div id="footer">
    Las texturas son cortes&iacutea de <a href="http://maps.jpl.nasa.gov/">Jet Propulsion Laboratory</a>.
</div>
<script>
    $("a").on("click", function () {
        var id = $(this).data("section");
        $("section:visible").fadeOut(function () {
            $(id).fadeIn();
        });
    });
    $("#scene").bind("wheel mousewheel", function (e) {
        e.preventDefault()
    });
</script>

</body>

</html>
