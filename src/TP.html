<html>

<head>
    <link rel="stylesheet" href="estilo.css">
    <title>Trabajo Pr&#225;ctico</title>
    <meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">

    <script type="text/javascript" src="js/gl-matrix.js"></script>
    <script type="text/javascript" src="js/webgl-utils.js"></script>
    <script type="text/javascript" src="js/dat.gui.min.js"></script>
    <script type="text/javascript" src="js/jquery-2.2.4.min.js"></script>
    <script type="text/javascript" src="js/Util/Calculator.js"></script>
    <script type="text/javascript" src="js/GraphicalUserInterfaceControl/GraphicalUserInterfaceControl.js"></script>
    <script type="text/javascript" src="js/TextureHandler.js"></script>
    <script type="text/javascript" src="js/Definitions/Definitions.js"></script>
    <script type="text/javascript" src="js/Camera/MouseController.js"></script>
    <script type="text/javascript" src="js/Camera/KeyboardController.js"></script>
    <script type="text/javascript" src="js/Camera/MoveBackward.js"></script>
    <script type="text/javascript" src="js/Camera/MoveForward.js"></script>
    <script type="text/javascript" src="js/Camera/MoveRight.js"></script>
    <script type="text/javascript" src="js/Camera/MoveLeft.js"></script>
    <script type="text/javascript" src="js/Camera/ToogleCamera.js"></script>
    <script type="text/javascript" src="js/Shader/Compiler.js"></script>
    <script type="text/javascript" src="js/Shader/Linker.js"></script>
    <script type="text/javascript" src="js/ModelViewMatrixStack.js"></script>
    <script type="text/javascript" src="js/GraphicContainer/WebGlRenderingContext.js"></script>
    <script type="text/javascript" src="js/GraphicContainer/ThreeDimensionRenderingContext.js"></script>
    <script type="text/javascript" src="js/GraphicContainer/TwoDimensionRenderingContext.js"></script>
    <script type="text/javascript" src="js/GraphicContainer/GraphicContainer.js"></script>
    <script type="text/javascript" src="js/GraphicContainer/SceneGraphicContainer.js"></script>
    <script type="text/javascript" src="js/GraphicContainer/RiverMapGraphicContainer.js"></script>
    <script type="text/javascript" src="js/Curves/Bspline.js"></script>
    <script type="text/javascript" src="js/Curves/BsplineMatrix.js"></script>
    <script type="text/javascript" src="js/AnimationFrame/AnimationFrame.js"></script>
    <script type="text/javascript" src="js/AnimationFrame/Scene.js"></script>

    <script type="text/javascript" src="js/GraphicalObject/GraphicalObject.js"></script>
    <script type="text/javascript" src="js/GraphicalObject/Cylinder.js"></script>
    <script type="text/javascript" src="js/GraphicalObject/SweptSurface.js"></script>
    <script type="text/javascript" src="js/GraphicalObject/RevolutionSurface.js"></script>
    <script type="text/javascript" src="js/GraphicalObject/Grass.js"></script>
    <script type="text/javascript" src="js/GraphicalObject/GrassLeftSide.js"></script>
    <script type="text/javascript" src="js/GraphicalObject/GrassRightSide.js"></script>
    <script type="text/javascript" src="js/GraphicalObject/Street.js"></script>
    <script type="text/javascript" src="js/GraphicalObject/TowerBody.js"></script>
    <script type="text/javascript" src="js/GraphicalObject/TowerJunction.js"></script>
    <script type="text/javascript" src="js/GraphicalObject/Tower.js"></script>
    <script type="text/javascript" src="js/GraphicalObject/BridgeTensor.js"></script>
    <script type="text/javascript" src="js/GraphicalObject/Bridge.js"></script>
    <script type="text/javascript" src="js/GraphicalObject/Ground.js"></script>
    <script type="text/javascript" src="js/GraphicalObject/Tree.js"></script>
    <script type="text/javascript" src="js/GraphicalObject/TreeCrown.js"></script>
    <script type="text/javascript" src="js/GraphicalObject/TreeTrunk.js"></script>
    <script type="text/javascript" src="js/Camera/Camera.js"></script>
    <script type="text/javascript" src="js/Camera/Orbital.js"></script>
    <script type="text/javascript" src="js/Camera/PedestrianCamera.js"></script>
    <script type="text/javascript" src="js/AnimationFrame/RiverMap.js"></script>
    <script id="shader-vs" type="x-shader/x-vertex">
			attribute vec3 aVertexPosition;
			attribute vec3 aVertexNormal;
			attribute vec3 aVertexTangent;
			attribute vec3 aVertexBinormal;
			attribute vec2 aTextureCoord;

			uniform mat4 uInverseVMatrix;
			uniform mat4 uMVMatrix;
			uniform mat4 uPMatrix;
			uniform mat3 uNMatrix;

			varying vec3 normalInterp;
			varying vec3 tangentInterp;
			varying vec3 binormalInterp;

			varying vec3 vertPos;
			varying vec2 vTextureCoord;


			void main(){
				float x = aVertexPosition.x;
				float y = aVertexPosition.y;
				float z = aVertexPosition.z;

				vec3 normal = aVertexNormal;
				vec3 tangent = aVertexTangent;
				vec3 binormal = aVertexBinormal;

				vTextureCoord = aTextureCoord;


    			gl_Position = uPMatrix * uMVMatrix * vec4(x, y, z, 1.0);
    			vec4 vertPos4 = uMVMatrix * vec4(x, y, z, 1.0);
    			vertPos = vec3(vertPos4) / vertPos4.w;

    			normalInterp = normalize(uNMatrix * normal);
    			tangentInterp = normalize(uNMatrix * tangent);
    			binormalInterp = normalize(uNMatrix * binormal);

			}

    </script>

    <script id="shader-fs" type="x-shader/x-fragment">
			uniform bool uUseNormalMap;
			precision mediump float;
			uniform sampler2D uSampler;
			uniform sampler2D uNormalSampler;


			varying vec3 normalInterp;
			varying vec3 tangentInterp;
			varying vec3 binormalInterp;

			varying vec3 vertPos;
			varying vec2 vTextureCoord;

			struct Light{
    			vec3 Position; // Light position in eye coords.
    			vec3 La; // Ambient light intensity
    			vec3 Ld; // Diffuse light intensity
    			vec3 Ls; // Specular light intensity
			};
			uniform Light uLight;

			struct Material{
				vec3 Ka; // Ambient light
    			vec3 Kd; // Diffuse light
    			vec3 Ks; // Specular light
    			float Shininess;
			};

			uniform Material uMaterial;

			void main() {
    			vec3 normal = normalize(normalInterp);

    			vec3 lightDir = normalize(uLight.Position - vertPos);

    			vec3 viewDir = normalize(-vertPos);

    			float lambertian = max(dot(lightDir,normal), 0.0);
    			float specular = 0.0;

    			vec3 vLight = uLight.La * uMaterial.Ka + lambertian * uLight.Ld * uMaterial.Kd + specular * uLight.Ls * uMaterial.Ks;

    			vec4 textureColor = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));
				gl_FragColor = vec4(textureColor.rgb * vLight, textureColor.a);

			}

    </script>

    <script type="text/javascript">
        var scene;
        var riverMap;
        var keyboardController;
        var controlValues = {
            alturaMaxima: 10,
            reiniciar: function () {
                refreshScene();
            },
            ph1: 5,
            ph2: 5,
            ph3: 5,
            s1: 1,
            towerAmount: 2,
            bridgePosition: 50
        };
        var graphicalUSerInterfaceControl;
        function webGLStart() {
            try {
                graphicalUSerInterfaceControl = new GraphicalUserInterfaceControl();
                graphicalUSerInterfaceControl.start();
                riverMap = new RiverMap();
                riverMap.tick();
                refreshScene();
            } catch (e) {
                alert(e.name + " " + e.message);
            }
        }
        function refreshScene() {
            scene = new Scene(riverMap);
            keyboardController = new KeyboardController(scene);
            scene.tick();
        }
    </script>

</head>
<body onload="webGLStart();">
<div style="text-align: right;">
    <canvas id="scene" style="border: double transparent;" width="1024" height="720">
        Your browser does not support the HTML5 canvas element.
    </canvas>
    <canvas id="riverMap" style="border: solid#696969;" width="360" height="360">
        Your browser does not support the HTML5 canvas element.
    </canvas>
</div>
<br>
<div id="header">
    <h1>Tp Sistemas gr&aacuteficos - Ali, Luis - 2do. cuatrimestre de 2016</h1>
</div>
<div id="ref">
    <a href="#/" data-section="#camaras">Cambiar C&aacutemaras</a><br>
    <a href="#/" data-section="#CamaraOrbital">C&aacutemara orbital</a><br>
    <a href="#/" data-section="#CamaraPrimeraPersona">C&aacutemara primera persona</a>
</div>
<section id="camaras">
    <h2>Alternar C&aacutemaras</h2>
    <dl>
        <dt class="thick"><b style="color:blue;">Aletrna en el &oacuterden Orbital / Persona en el puente / Persona en
            el barco</b></dt>
        <dd class="italic">Tecla <b>C</b></dd>
    </dl>
</section>
<section id="CamaraOrbital">
    <h2>C&aacutemara orbital</h2>
    <dl>
        <dt class="thick">Zoom</dt>
        <dd class="italic">Acercar/Alejar, Mover rueda del mouse <b>Arriba/Abajo</b>
        <dd>
        <dt class="thick">Rotar la escena</dt>
        <dd class="italic">Mantener bot&oacuten izquierdo del mouse presionado y mover el mouse</dd>
    </dl>
</section>
<section id="CamaraPrimeraPersona">
    <h2>C&aacutemara de primera persona <b style="color:blue;font-size:70%;">(tanto en el puente como en el barco)</b>
    </h2>
    <dl>
        <dt class="thick">Desplazarse</dt>
        <dd class="italic">Izquierda/Atr&aacutes/Derecha/Adelante, <b>a/s/d/w</b> respectivamente
        <dd>
        <dt class="thick">Girar vista</dt>
        <dd class="italic">Mover el mouse manteniendo presionado el bot&oacuten izquierdo. La c&aacutemara mira al
            puntero del mouse
        </dd>
    </dl>
</section>
</section>
<div id="footer">
    Las texturas son cortes&iacutea de <a href="http://maps.jpl.nasa.gov/">Jet Propulsion Laboratory</a>.
</div>
<script>
    $("a").on("click", function () {
        var id = $(this).data("section");
        $("section:visible").fadeOut(function () {
            $(id).fadeIn();
        });
    });
    $("#scene").bind("wheel mousewheel", function (e) {
        e.preventDefault()
    });
</script>

</body>

</html>
